{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { EventBus } from \"@/main\";\nexport default {\n  name: \"ActorEditProfile\",\n  props: {\n    actorId: {\n      type: String,\n      required: true\n    }\n  },\n  watch: {\n    actorId: {\n      handler: function () {\n        this.retrieveProfileInfo();\n      }\n    },\n    'profile.languages.value': {\n      handler: function (langs) {\n        this.checkLangSkills(langs);\n      }\n    }\n  },\n  created() {\n    this.retrieveProfileInfo();\n    EventBus.$on('actorEditionForm_actorEditProfile_save', this.save);\n  },\n  methods: {\n    checkLangSkills(langs) {\n      langs.forEach(lang => {\n        const index = this.languagesSkill.findIndex(ls => ls.lang == lang);\n        console.log(index);\n        if (index === -1) {\n          this.languagesSkill.push({\n            lang: lang,\n            percent: 0\n          });\n        }\n      });\n    },\n    save() {\n      const actor = {};\n      for (let profileKey in this.profile) {\n        if (this.profile[profileKey].value != null) {\n          if (profileKey !== 'languages') {\n            actor[profileKey] = this.profile[profileKey].value;\n          } else {\n            actor[profileKey] = this.languagesSkill;\n          }\n        }\n      }\n      if (actor.name.length < 1 && Object.keys(actor).length < 1) {\n        EventBus.$emit('alert', {\n          color: 'red',\n          type: 'error',\n          msg: 'El perfil no puede estar vacío'\n        });\n        return;\n      }\n      EventBus.$emit('toActorEditionForm_save', actor);\n    },\n    retrieveProfileInfo() {\n      this.axios.get(`/profile/retrieve/${this.actorId}`).then(res => {\n        for (let profileKey in this.profile) {\n          if (profileKey !== 'languages') {\n            this.profile[profileKey].value = res.data[profileKey];\n          } else {\n            res.data[profileKey].forEach(lang => {\n              this.profile[profileKey].value.push(lang.lang);\n            });\n          }\n        }\n      }).catch(e => {\n        EventBus.$emit('alert', {\n          color: 'red',\n          type: 'error',\n          msg: e.response.data.message\n        });\n      });\n    }\n  },\n  data: () => ({\n    profile: {\n      name: {\n        label: \"Nombre\",\n        icon: \"mdi-form-textbox\",\n        type: \"text\",\n        value: null\n      },\n      age: {\n        label: \"Edad\",\n        icon: \"mdi-cake-variant-outline\",\n        type: \"text\",\n        value: null\n      },\n      hair: {\n        label: \"Cabello\",\n        icon: \"mdi-hair-dryer-outline\",\n        type: \"text\",\n        value: null\n      },\n      eyes: {\n        label: \"Ojos\",\n        icon: \"mdi-eye-outline\",\n        type: \"text\",\n        value: null\n      },\n      height: {\n        label: \"Altura\",\n        icon: \"mdi-human-male-height\",\n        type: \"text\",\n        value: null\n      },\n      languages: {\n        label: \"Idiomas\",\n        icon: \"mdi-account-voice\",\n        type: \"combobox\",\n        value: null\n      },\n      skills: {\n        label: \"Habilidades\",\n        icon: \"mdi-drama-masks\",\n        type: \"combobox\",\n        value: null\n      },\n      sex: {\n        label: \"Sexo\",\n        icon: \"mdi-human\",\n        type: \"select\",\n        chips: false,\n        multiple: false,\n        items: ['Hombre', 'Mujer', 'Otros', 'Sin indicar'],\n        value: null\n      }\n    },\n    languagesSkill: []\n  })\n};","map":{"version":3,"mappings":";AAsEA;AAEA;EACAA;EACAC;IACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAH;MACAI;QACA;MACA;IACA;IACA;MACAA;QACA;MACA;IACA;EACA;EACAC;IACA;IACAC,uDACA,UACA;EACA;EACAC;IACAC;MACAC;QACA;QACAC;QACA;UACA;YACAC;YACAC;UACA;QACA;MACA;IACA;IACAC;MACA;MAEA;QACA;UACA;YACAC;UACA;YACAA;UACA;QACA;MACA;MAEA;QACAR;UACAS;UACAd;UACAe;QACA;QACA;MACA;MAEAV;IACA;IACAW;MACA,WACAC,yCACAC;QACA;UACA;YACA;UACA;YACAC;cACA;YACA;UACA;QACA;MACA,GACAC;QACAf;UACAS;UACAd;UACAe;QACA;MACA;IACA;EACA;EACAM;IACAC;MACAzB;QACA0B;QACAC;QACAxB;QACAyB;MACA;MACAC;QACAH;QACAC;QACAxB;QACAyB;MACA;MACAE;QACAJ;QACAC;QACAxB;QACAyB;MACA;MACAG;QACAL;QACAC;QACAxB;QACAyB;MACA;MACAI;QACAN;QACAC;QACAxB;QACAyB;MACA;MACAK;QACAP;QACAC;QACAxB;QACAyB;MACA;MACAM;QACAR;QACAC;QACAxB;QACAyB;MACA;MACAO;QACAT;QACAC;QACAxB;QACAiC;QACAC;QACAC;QACAV;MACA;IACA;IACAW;EACA;AACA","names":["name","props","actorId","type","required","watch","handler","created","EventBus","methods","checkLangSkills","langs","console","lang","percent","save","actor","color","msg","retrieveProfileInfo","get","then","res","catch","data","profile","label","icon","value","age","hair","eyes","height","languages","skills","sex","chips","multiple","items","languagesSkill"],"sourceRoot":"src/components/forms","sources":["ActorEditProfile.vue"],"sourcesContent":["<template>\n  <v-row>\n    <v-col>\n      <v-list\n          subheader\n      >\n        <v-subheader class=\"mt-4\">\n          <v-icon class=\"mr-4\">mdi-notebook-outline</v-icon>\n          INFORMACIÓN PRINCIPAL <span class=\"caption ml-4\">(Los campos que no se rellenen, no saldrán en la ficha)</span>\n        </v-subheader>\n      </v-list>\n      <v-divider></v-divider>\n      <v-list>\n        <v-list-item\n            v-for=\"input in profile\"\n            :key=input.text\n            v-if=\"input.type\"\n        >\n            <v-text-field\n                v-if=\"input.type === 'text'\"\n                :prepend-icon=input.icon\n                :label=input.label\n                v-model=input.value\n            ></v-text-field>\n          <v-combobox\n              v-if=\"input.type === 'combobox'\"\n              :prepend-icon=input.icon\n              :label=input.label\n              v-model=input.value\n              multiple\n              chips\n          ></v-combobox>\n            <v-select\n                v-if=\"input.type === 'select'\"\n                :prepend-icon=input.icon\n                :label=input.label\n                v-model=input.value\n                :items=input.items\n                :chips=input.chips\n                :multiple=input.multiple\n            ></v-select>\n        </v-list-item>\n      </v-list>\n      <template v-if=\"languagesSkill.length > 0\">\n        <v-list>\n          <v-subheader>\n            <v-icon class=\"mr-4\">mdi-translate-variant</v-icon>\n            Configurar Idiomas\n          </v-subheader>\n        </v-list>\n        <v-divider></v-divider>\n        <v-list>\n          <v-list-item\n              v-for=\"lang in languagesSkill\"\n          >\n            <v-progress-linear\n                v-model=\"lang.percent\"\n                color=\"blue-grey\"\n                height=\"25\"\n            >\n              <strong>{{ lang.lang }}: {{ Math.ceil(lang.percent).toFixed(0) }}%</strong>\n            </v-progress-linear>\n          </v-list-item>\n        </v-list>\n      </template>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nimport {EventBus} from \"@/main\";\n\nexport default {\n  name: \"ActorEditProfile\",\n  props: {\n    actorId: {\n      type: String,\n      required: true\n    },\n  },\n  watch: {\n    actorId: {\n      handler: function () {\n        this.retrieveProfileInfo();\n      }\n    },\n    'profile.languages.value': {\n      handler: function (langs){\n        this.checkLangSkills(langs);\n      }\n    }\n  },\n  created() {\n    this.retrieveProfileInfo();\n    EventBus.$on('actorEditionForm_actorEditProfile_save',\n        this.save\n    );\n  },\n  methods: {\n    checkLangSkills(langs){\n      langs.forEach( lang => {\n        const index = this.languagesSkill.findIndex( ls => ls.lang == lang);\n        console.log(index)\n        if (index === -1){\n          this.languagesSkill.push({\n            lang: lang,\n            percent: 0\n          });\n        }\n      });\n    },\n    save(){\n      const actor = {};\n\n      for (let profileKey in this.profile) {\n        if (this.profile[profileKey].value != null){\n          if (profileKey !== 'languages'){\n            actor[profileKey] = this.profile[profileKey].value;\n          } else {\n            actor[profileKey] = this.languagesSkill;\n          }\n        }\n      }\n\n      if (actor.name.length < 1 && Object.keys(actor).length < 1){\n        EventBus.$emit('alert',{\n          color: 'red',\n          type: 'error',\n          msg: 'El perfil no puede estar vacío'\n        });\n        return;\n      }\n\n      EventBus.$emit('toActorEditionForm_save',actor);\n    },\n    retrieveProfileInfo(){\n      this.axios\n          .get(`/profile/retrieve/${this.actorId}`)\n          .then( res => {\n            for (let profileKey in this.profile) {\n              if (profileKey !== 'languages'){\n                this.profile[profileKey].value = res.data[profileKey];\n              } else {\n                res.data[profileKey].forEach( lang => {\n                  this.profile[profileKey].value.push(lang.lang);\n                });\n              }\n            }\n          })\n          .catch( e => {\n            EventBus.$emit('alert',{\n              color: 'red',\n              type: 'error',\n              msg: e.response.data.message\n            });\n          });\n    }\n  },\n  data: () => ({\n    profile: {\n      name: {\n        label: \"Nombre\",\n        icon: \"mdi-form-textbox\",\n        type: \"text\",\n        value: null\n      },\n      age: {\n        label: \"Edad\",\n        icon: \"mdi-cake-variant-outline\",\n        type: \"text\",\n        value: null\n      },\n      hair: {\n        label: \"Cabello\",\n        icon: \"mdi-hair-dryer-outline\",\n        type: \"text\",\n        value: null\n      },\n      eyes: {\n        label: \"Ojos\",\n        icon: \"mdi-eye-outline\",\n        type: \"text\",\n        value: null\n      },\n      height: {\n        label: \"Altura\",\n        icon: \"mdi-human-male-height\",\n        type: \"text\",\n        value: null\n      },\n      languages: {\n        label: \"Idiomas\",\n        icon: \"mdi-account-voice\",\n        type: \"combobox\",\n        value: null\n      },\n      skills: {\n        label: \"Habilidades\",\n        icon: \"mdi-drama-masks\",\n        type: \"combobox\",\n        value: null\n      },\n      sex: {\n        label: \"Sexo\",\n        icon: \"mdi-human\",\n        type: \"select\",\n        chips: false,\n        multiple: false,\n        items: ['Hombre','Mujer','Otros','Sin indicar'],\n        value: null\n      },\n    },\n    languagesSkill: []\n  })\n}\n</script>\n\n<style scoped>\n\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}